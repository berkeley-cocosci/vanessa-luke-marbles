% 1item_ins[i] is the count of blue marbles observed by the ith participant.  1item_outs[i] is the count of blue marbles produced by the ith participant.

one_item_ins = [5,5,7,7,7,7,5,5,7,7,3,3,5,5,3,7,3,3,5,5,3,3,3,3,3,5,5,7,5,7,3,3,5,5,5,7,5,3,7,5,5,5,7,7,7,5,5,5,3,7,5,5,5,5,5,7,3,6,4,6,6,6,4,4,4,6,6,6,4,6,4,6,4,8,8,8,8,8,6,6,8,8,6,6,4,4,2,2,2,2,8,2,6,2,2,8,8,8,9,9,9,8,2,2,6,6,4,9,2,4,5,1,9,4,8,1,1,9,1,1,9,9,5,1,9,9,5,1,9,2,2,9,1,1,1,4,1,5,3,4,1,2,9,1,4,2,1,5,2,5,8,9,4,2,1,1,9,8,8,9,10,10,10,0,0,10,10,10,0,10,0,10,0,10,10,0,0,0,0,0,10,0,10,0,10,10,10,0,0,0,0,10];

one_item_outs = [5,4,5,8,7,5,5,5,6,7,3,2,6,5,4,7,4,3,5,6,2,3,3,3,3,2,4,6,5,6,3,4,5,5,6,5,5,4,10,6,5,6,7,7,5,5,5,5,3,6,9,5,4,6,5,8,4,5,6,6,6,6,3,5,5,7,5,5,4,6,5,6,7,8,6,9,8,8,6,5,8,8,8,6,3,4,3,4,1,2,9,3,7,6,3,8,8,8,8,9,8,8,2,2,6,5,4,7,2,5,4,0,8,3,7,1,1,9,5,1,9,10,4,1,9,2,5,2,9,2,2,9,1,2,1,6,1,6,2,5,1,2,9,1,4,2,0,6,2,5,8,10,6,2,1,1,9,8,7,9,9,10,10,0,0,10,10,8,0,10,0,10,0,9,7,0,3,1,0,0,10,5,10,0,10,5,10,0,0,0,0,10];

% 6item_outs is an array of tuples where each tuple contains one participant's output counts of marble1 for each of the 6 bags.  The input counts of marble1 are 0,1,2,3,4,5) for all participants.

six_item_outs = [0, 0, 1, 3, 1, 9;
 4, 5, 4, 1, 6, 7;
 0, 0, 0, 0, 10, 10;
 5, 6, 7, 6, 6, 5;
 0, 1, 0, 0, 7, 5;
 0, 10, 0, 0, 0, 0;
 0, 0, 10, 1, 1, 6;
 0, 2, 1, 2, 1, 2;
 2, 4, 6, 5, 3, 4;
 4, 4, 4, 3, 4, 6;
 0, 0, 0, 0, 9, 10;
 0, 10, 0, 2, 0, 1;
 0, 0, 2, 2, 0, 2;
 0, 0, 0, 9, 2, 1;
 0, 1, 2, 6, 1, 3;
 0, 0, 0, 8, 10, 6;
 0, 0, 0, 0, 7, 6;
 0, 8, 2, 1, 1, 3;
 1, 1, 4, 5, 5, 5;
 0, 0, 0, 3, 0, 10;
 0, 1, 4, 2, 4, 4;
 8, 4, 2, 1, 8, 5;
 7, 7, 5, 6, 7, 6;
 4, 5, 2, 6, 4, 5;
 0, 0, 10, 0, 7, 0;
 2, 3, 3, 4, 3, 5;
 0, 0, 0, 1, 5, 3;
 0, 0, 2, 3, 1, 1;
 1, 0, 2, 2, 4, 8;
 0, 0, 0, 5, 0, 2;
 0, 0, 4, 4, 5, 2;
 0, 0, 0, 0, 10, 5;
 3, 2, 3, 2, 8, 4;
 0, 0, 0, 3, 3, 5;
 0, 1, 2, 2, 4, 7;
 0, 0, 1, 3, 2, 8;
 2, 1, 2, 1, 1, 4;
 0, 0, 0, 0, 0, 10;
 0, 0, 0, 0, 10, 0;
 0, 0, 1, 1, 10, 10;
 1, 2, 0, 2, 2, 4;
 0, 7, 5, 5, 2, 7;
 2, 5, 5, 2, 7, 4;
 0, 0, 0, 10, 9, 10;
 1, 8, 7, 4, 4, 5;
 2, 8, 4, 4, 7, 6;
 0, 1, 0, 0, 8, 8;
 0, 0, 0, 3, 10, 10;
 5, 7, 6, 5, 6, 3;
 1, 10, 0, 0, 10, 0;
 0, 0, 0, 3, 10, 4;
 0, 2, 4, 0, 1, 5;
 3, 5, 6, 4, 4, 5;
 0, 0, 1, 3, 0, 9;
 0, 0, 0, 0, 0, 10;
 4, 5, 2, 2, 3, 6;
 0, 0, 2, 2, 3, 8;
 1, 1, 0, 2, 2, 0;
 0, 0, 6, 0, 1, 0;
 3, 4, 3, 5, 5, 7;
 0, 0, 10, 0, 0, 0;
 3, 3, 5, 5, 4, 6;
 7, 5, 1, 3, 4, 5;
 0, 0, 4, 3, 3, 5];

max_ll = -1000000;
best_alpha = 1;
best_rho1 = 0.5;
best_rho6 = 0.5;
alpha=0.72;
for alpha=0.4:0.05:0.6
    for rho1=0.5:0.01:1.0
        for rho6=0.2:0.01:1.0
            ll = loglike1d(one_item_ins, one_item_outs, marbles(alpha, rho1, 10));
            ll = ll + loglike6d(six_item_outs, marbles(alpha, rho6, 10));
%             display(ll);
%             display(max_ll);
            if(ll > max_ll)
                max_ll = ll;
                best_alpha = alpha;
                best_rho1 = rho1;
                best_rho6 = rho6;
                sprintf('Alpha: %f\tBest Rho1: %f\tBest Rho6:%f\tLoglike:%f\n', best_alpha, best_rho1, best_rho6, max_ll)
            end
        end
    end
end

% max_ll = -1000000;
% best_alpha = 1;
% for alpha=0.1:0.01:2.0
%             ll = loglike1d(one_item_ins, one_item_outs, marbles(alpha, 1.0, 10));           
%             if(ll > max_ll)
%                 max_ll = ll;
%                 best_alpha = alpha;                
%                 sprintf('Alpha: %f\n', best_alpha)
%             end    
% end

% LL = [];
% for rho=0:0.01:1.0
%     ll = loglike1d(one_item_ins, one_item_outs, marbles(0.5, rho, 10));
%     LL = [LL ll];
%     %sprintf('%f: %f\n', rho, ll);
% end
% 
% LL = [];
% for rho=0:0.01:1.0
%     ll = loglike6d(six_item_outs, marbles(1, rho, 10));
%     LL = [LL ll];
%     %sprintf('%f: %f\n', rho, ll);
% end
% 
% plot(LL)
